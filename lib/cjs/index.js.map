{"version":3,"file":"index.js","sources":["../../src/fetcher.jsx","../../src/useFetch.jsx","../../src/useIntersectionObserver.jsx","../../src/Ymage.jsx"],"sourcesContent":["\r\nconst cache = new Map();\r\n\r\nconst fetch_queue = {\r\n  max_concurent: 30,\r\n  pending: 0,\r\n  queue: [...Array(3)].map( () => [] ),\r\n  add: (fetch_task, priority) => {\r\n    fetch_queue.queue[priority-1].push(fetch_task);\r\n    fetch_queue.rescan();\r\n  },\r\n  rescan: ()=>{\r\n    let slots = fetch_queue.max_concurent - fetch_queue.pending;\r\n    for(; slots > 0; --slots){\r\n      for(const priority_group of fetch_queue.queue){\r\n        if(priority_group.length){\r\n          fetch_queue.start(priority_group.shift());\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  start: (fetch_task)=>{\r\n    fetch_queue.pending++;\r\n    const promise = fetch(fetch_task.url)\r\n      .then(\r\n        (response) => {\r\n          cache.set(fetch_task.url, response.clone());\r\n          fetch_task.resolve(response);\r\n          fetch_queue.pending--;\r\n          fetch_queue.rescan();\r\n\r\n        }, \r\n        (error)=>{\r\n          fetch_task.reject(error);\r\n          fetch_queue.pending--;\r\n          fetch_queue.rescan();\r\n        }\r\n      )\r\n  }\r\n}\r\n\r\n\r\nexport const fetcher = (url, priority=3) => {\r\n  if (cache.has(url)){\r\n      const promise = new Promise((resolve, reject) => {\r\n          resolve(cache.get(url).clone());\r\n      });\r\n      return promise;\r\n  } else {\r\n      const promise = new Promise((resolve, reject) => {\r\n          const fetch_task = {\r\n            url: url,\r\n            resolve: (response) => {resolve(response)},\r\n            reject:  (error) => {reject(error)},\r\n          }\r\n          fetch_queue.add(fetch_task, priority);\r\n      })\r\n\r\n    return promise;\r\n  }\r\n}\r\n\r\n","import { useState, useRef } from 'react';\r\nimport { fetcher } from './fetcher.jsx';\r\n\r\n\r\nconst defaults = {\r\n  while_updating: \"loader\", // loader, static\r\n};\r\n\r\n\r\n\r\nexport default function useFetch (options) {\r\n  const type_select = {\r\n    blob:()=>{return FetchOptions({...options, type: \"blob\"})},\r\n    json:()=>{return FetchOptions({...options, type: \"json\"})},\r\n    text:()=>{return FetchOptions({...options, type: \"text\"})}\r\n  }\r\n  return type_select\r\n}\r\n\r\n\r\n\r\nconst FetchOptions = options => useFetcher({...defaults, ...options})\r\n\r\n\r\nconst useFetcher = (options) => {  \r\n    const request = useRef({\r\n        state: \"PENDING\",\r\n        url: null, \r\n    });\r\n  \r\n    const [retrieved, setRetrieved] = useState();\r\n    const last_content = useRef(null);\r\n    const fetched_data = useRef(initFetchData[options.type]);\r\n\r\n    const onLoad = (data) => {\r\n        fetched_data.current = data;\r\n        request.current.state = \"OK\";\r\n        setRetrieved(data);\r\n    }\r\n\r\n    const onError = (err) => {\r\n        fetched_data.current = err;\r\n        request.current.state = \"ERROR\";\r\n    }\r\n\r\n    const load = (url) => {\r\n        if(request.current.url !== url){\r\n            request.current.url = url;                \r\n            request.current.state = \"PENDING\";\r\n            fetcher(request.current.url, 3)\r\n            .then(data => {\r\n                switch(options.type){\r\n                    case \"blob\": return data.blob();\r\n                    case \"json\": return data.json();\r\n                    case \"text\": return data.text();\r\n            }})\r\n            .then(data => onLoad(data))\r\n            .catch(error => onError(error))\r\n        }\r\n    }\r\n\r\n\r\n    const Wrapper = ({ url, children, loader = null, error =  null }) => {\r\n        load(url)\r\n\r\n        switch(request.current.state){\r\n            case \"PENDING\":\r\n                if(options.while_updating==\"static\" && last_content)\r\n                    return last_content;\r\n                else \r\n                    return loader;\r\n                break;\r\n            case \"ERROR\":\r\n                return null;\r\n                break;\r\n            default: \r\n                last_content.current = children; \r\n                return children;\r\n                break;\r\n        }\r\n    }\r\n\r\n  return  [fetched_data.current, Wrapper];\r\n}\r\n\r\n\r\n\r\n  const initFetchData =  {\r\n    blob: new Blob(), \r\n    json: {},\r\n    text:  \"\"\r\n  };\r\n","import { useState, useEffect } from 'react'\r\n\r\nconst useIntersectionObserver = (element, margin=0) => {\r\n    const [isVisible, setState] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const observer = new IntersectionObserver(\r\n            ([entry]) => {\r\n              if (entry.isIntersecting) {\r\n                setState(entry.isIntersecting);\r\n                observer.disconnect();\r\n              }\r\n            }, { rootMargin: margin }\r\n        );\r\n        element.current && observer.observe(element.current);\r\n        return () => observer.disconnect() \r\n    }, []);\r\n\r\n    return isVisible;\r\n};\r\nexport default useIntersectionObserver;\r\n","import { useRef } from 'react';\r\nimport './Ymage.scss';\r\nimport useFetch from \"./useFetch.jsx\";\r\nimport useIntersectionObserver from \"./useIntersectionObserver.jsx\"\r\n\r\nconst cached_images = new Map();\r\n\r\nexport default function Ymage({url, copyright, lazy=\"200px\", type=\"img\", onLoad, style, className=\"\", ...props}) {\r\n\tconst container = useRef();\r\n\tconst isVisible = (lazy === false) ? true : useIntersectionObserver(container, lazy);\r\n    const options = {as: type, copyright: copyright}; \r\n\r\n    function stylesFromProps(props) {\r\n        const styles = {};\r\n        if(props.w) styles.width = props.w;\r\n        if(props.h) styles.height = props.h;\r\n        if(props.r) styles.borderRadius = props.r;\r\n        if(props.wh) styles.aspectRatio = props.wh;\r\n        return styles;\r\n    }\r\n\r\n    function contextMenuHandler(){\r\n        if(options.copyright) {\r\n            container.current.classList.add(\"copyright\")\r\n            setTimeout(() => container.current.classList.remove(\"copyright\"), 1000);\r\n        }\r\n    }\r\n\r\n    return (\r\n\t\t<figure \r\n        {...props} \r\n        style={{...stylesFromProps(props), ...style}}\r\n        ref={container} \r\n        className={\"Ymage \" + className}\r\n        onContextMenu={contextMenuHandler}>\r\n\t\t\t{isVisible ? \r\n                cached_images.has(url) ? \r\n                    <PrintImage url={cached_images.get(url).blob_url} options={options} />\r\n                :   <FetchImage url={url} options={options} onLoad={onLoad}/>\r\n            : null }\r\n\t\t</figure>\r\n\t)\r\n}\r\n\r\n\r\nconst FetchImage = ({url, options, onLoad}) => {\r\n\tconst [data, Fetch] = useFetch().blob();\r\n \r\n    return(\r\n        <Fetch url={url} loader={<Loader/>}>\r\n\t\t    <CacheImage url={url} blob={data} options={options} onLoad={onLoad}/>\r\n\t\t</Fetch>\r\n    )\r\n}\r\n\r\nconst CacheImage = ({url, blob, options, onLoad}) => {\r\n    const blob_url = URL.createObjectURL(blob);\r\n    const img_tmp = new Image();\r\n    img_tmp.src = blob_url;\r\n    img_tmp.onload = () => {\r\n        const img_size = {x: img_tmp.width, y: img_tmp.height};\r\n        cached_images.set(url, {blob_url: blob_url, size: img_size});\r\n        if(onLoad) onLoad({blob_url: blob_url, size: img_size})\r\n        img_tmp.src = null; \r\n    }\r\n\r\n    return <PrintImage url={blob_url} options={{...options, entry: \"fade-in\"}}/>\r\n}\r\n\r\nconst PrintImage = ({url, options}) => {\r\n    if(options.as === \"img\")\r\n        return <img\r\n            src={url} \r\n            className = {(options.entry ? options.entry : \"\") + (options.copyright ? \" copyright\" : \"\")}\r\n            />\r\n    else return <div \r\n            className = {options.entry ? options.entry : \"\" + (options.copyright ? \" copyright\" : \"\")} \r\n            style = {{backgroundImage:\"url('\" + url + \"')\"}}\r\n            ></div>\r\n}\r\n\r\n\r\nconst Loader = () =>{\r\n\treturn( \r\n        <svg \r\n            className=\"ymage-spinner\" \r\n            xmlns=\"http://www.w3.org/2000/svg\" \r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\" \r\n            viewBox=\"0 0 100 100\" \r\n            enableBackground=\"new 0 0 0 0\" >\r\n\r\n            <path fill=\"#fff\" d=\"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50\"></path>\r\n        </svg>\r\n    )\r\n}\r\n\r\n\r\n"],"names":["cache","Map","fetch_queue","max_concurent","pending","queue","Array","map","add","fetch_task","priority","push","rescan","slots","priority_group","length","start","shift","fetch","url","then","response","set","clone","resolve","error","reject","fetcher","has","promise","Promise","get","defaults","while_updating","useFetch","options","type_select","blob","FetchOptions","type","json","text","useFetcher","request","useRef","state","retrieved","setRetrieved","useState","last_content","fetched_data","initFetchData","onLoad","data","current","onError","err","load","catch","Wrapper","children","loader","Blob","useIntersectionObserver","element","margin","isVisible","setState","useEffect","observer","IntersectionObserver","entry","isIntersecting","disconnect","rootMargin","observe","cached_images","Ymage","copyright","lazy","style","className","props","container","as","stylesFromProps","styles","w","width","h","height","r","borderRadius","wh","aspectRatio","contextMenuHandler","classList","setTimeout","remove","React","createElement","_extends","ref","onContextMenu","PrintImage","blob_url","FetchImage","Fetch","Loader","CacheImage","URL","createObjectURL","img_tmp","Image","src","onload","img_size","x","y","size","backgroundImage","xmlns","xmlnsXlink","viewBox","enableBackground","fill","d"],"mappings":"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"}